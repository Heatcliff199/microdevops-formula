# https://github.com/percona/pmm-doc/blob/main/docs/_images/PMM_Architecture_Client_Server.jpg
pmm:
  docker-ce_version: 5:20.10.8*
  acme_account: example.com
  name: pmm.example.com
  admin_password: 'XXXXXXXXXXXXXXXX'
  plugins: grafana-image-renderer
  image: percona/pmm-server:2.26
  config: |
    [server]
    root_url = https://pmm.example.com/graph/
    enable_gzip = true
    [dashboards]
    # Path to the default home dashboard. If this value is empty, then Grafana uses StaticRootPath + "dashboards/home.json"
    default_home_dashboard_path = /usr/share/percona-dashboards/panels/pmm-app/dist/dashboards/Insight/Home_Dashboard.json
    [users]
    # Path to a custom home page. Users are only redirected to this if the default home dashboard is used. It should match a frontend route and contain a leading slash.
    home_page = d/pmm-home/home-dashboard
    [paths]
    # Directory where grafana will automatically scan and look for plugins
    plugins = /srv/grafana/plugins
    [plugins]
    # Enter a comma-separated list of plugin identifiers to identify plugins that are allowed to be loaded even if they lack a valid signature.
    allow_loading_unsigned_plugins = vertamedia-clickhouse-datasource,pmm-app,pmm-check-panel-home,pmm-update,pmm-qan-app-panel,pmm-pt-summary-panel,pmm-pt-summary-datasource
    [auth.gitlab]
    enabled = true
    allow_sign_up = true
    client_id = 7a08f6925bece27edabd5b9611ad6cdc639e1806ac1686001501098aa7770052
    client_secret = 1fb4662fc6bd9c07b07dbea683361328412d0fb808beaf81c4c234bd7f5b1c2e
    scopes = read_api
    auth_url = https://gitlab.example.com/oauth/authorize
    token_url = https://gitlab.example.com/oauth/token
    api_url = https://gitlab.example.com/api/v4
    allowed_groups = pmm
    [unified_alerting]
    enabled = false
    [alerting]
    enabled = true
  env_vars:
    DISABLE_UPDATES: true
